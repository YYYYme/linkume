<!DOCTYPE html>
<html>
  <head>
    <title>index.html</title>
	
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
 	<link type="text/css" rel="stylesheet" href="./static/plugins/css/bootstrap.css"></link>
 	<script type="text/javascript" src="./static/plugins/js/jquery-3.2.1.min.js"></script>
  </head>
  
  <body>
    <input type="button" class='btn btn-primary' value='用户' onclick="userList()"/>
    <input type="button" class='btn btn-primary' value='删除' onclick="deleteUserById()"/>
    <p id="show"></p>
    <table class='table table-striped table-bordered table-hover table-condensed' id="showUsers">
    	<tr >
    		<th>id</th>
    		<th>姓名</th>
    		<th>密码</th>
    		<th>年龄</th>
    	</tr>
    </table>
  </body>
  <script type="text/javascript">
  	//1.$.ajax带json数据的异步请求
  		$().ready(function(){
	  		var aj = $.ajax( {  
	  		    url:'./user/queryAllUser',//
	  		    data:{},  
	  		    type:'get',  
	  		    cache:false,  
	  		    dataType:'json',  
	  		    success:function(data) {  
	  		        if(data.msg =="true" ){
	  		        	var html="";
	  		        	console.log(data);
	  		        	for(var i=0;i<data.data.length;i++){
	  		        		html="<tr id='"+data.data[i].id+"'><td>"+data.data[i].id+"</td><td>"+data.data[i].userName+"</td><td>"+data.data[i].password+"</td><td>"+data.data[i].age+"</td></tr>";
	  		        		$(html).attr("ondblclick","deleteUserById(this)").appendTo($("#showUsers"))
	  		        	}  		            
	  		        }else{  
	  		        }  
	  		     },  
	  		     error : function() {  
	  		          alert("异常1！");  
	  		     }  
	  		});
  		});
  	function deleteUserById(obj){
  		var $temp=$(obj).attr("id")
  		var con=confirm("确认删除用户"+$temp+"?")
  		if(con=true){
	  		var aj = $.ajax( {  
	  		    url:'./user/deleteUser',
	  		    data:{id:$temp},  
	  		    type:'get',  
	  		    cache:false,  
	  		    dataType:'json',  
	  		    success:function(data) {  
	  		        if(data.ret =="true" ){  
	  		        	console.log(data);
	  		        	alert(data.msg)
	  		           	$.load('./user/queryAllUser');    
	  		        }else{ 
	  		        	console.log(data);
	  		        	alert(data.msg)
	  		        }  
	  		     },  
	  		     error : function() {  
	  		          alert("异常1！");  
	  		     }  
	  		});
  		}
  	}
  </script>
</html>